@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --primary: 262.1 83.3% 57.8%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --accent: 210 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --ring: 262.1 83.3% 57.8%;
    --radius: 0.875rem;
    
    /* Custom properties for enhanced UI */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    --animation-fast: 150ms;
    --animation-base: 250ms;
    --animation-slow: 350ms;
  }

  :root[class~="dark"] {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --primary: 263.4 70% 50.4%;
    --primary-foreground: 210 40% 98%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 85.7% 97.3%;
    --ring: 263.4 70% 50.4%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  
  html {
    @apply scroll-smooth;
  }
  
  body {
    @apply bg-background text-foreground antialiased;
    font-feature-settings: "rlig" 1, "calt" 1;
  }
  
  /* Custom scrollbar styles */
  ::-webkit-scrollbar {
    @apply w-3 h-3;
  }
  
  ::-webkit-scrollbar-track {
    @apply bg-transparent;
  }
  
  ::-webkit-scrollbar-thumb {
    @apply bg-muted-foreground/20 rounded-full;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    @apply bg-muted-foreground/30;
  }
  
  /* Selection styles */
  ::selection {
    @apply bg-primary/20 text-foreground;
  }
}

@layer components {
  /* Button styles */
  .btn-primary {
    @apply inline-flex items-center justify-center px-4 py-2.5 bg-primary text-primary-foreground rounded-xl hover:bg-primary/90 focus:ring-2 focus:ring-primary/20 focus:ring-offset-2 transition-all duration-200 font-medium shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed;
  }
  
  .btn-secondary {
    @apply inline-flex items-center justify-center px-4 py-2.5 bg-white dark:bg-slate-900 border border-border hover:bg-muted rounded-xl focus:ring-2 focus:ring-primary/20 focus:ring-offset-2 transition-all duration-200 font-medium shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed;
  }
  
  /* Card styles */
  .card {
    @apply bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl rounded-2xl border border-border/50 shadow-lg p-6;
  }
  
  /* Input styles */
  .input {
    @apply w-full px-4 py-2.5 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl border border-border/50 rounded-xl focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all duration-200 placeholder:text-muted-foreground/50;
  }
  
  /* Table styles */
  .table-header {
    @apply border-b border-border/50 bg-gray-50/50 dark:bg-slate-800/50;
  }
  
  .table-row {
    @apply border-b border-border/50 hover:bg-muted/30 transition-all duration-200;
  }
}

@layer utilities {
  /* Animation utilities */
  .animate-in {
    animation: animateIn var(--animation-base) ease-out;
  }
  
  .animate-out {
    animation: animateOut var(--animation-base) ease-in;
  }
  
  @keyframes animateIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @keyframes animateOut {
    from {
      opacity: 1;
      transform: translateY(0);
    }
    to {
      opacity: 0;
      transform: translateY(10px);
    }
  }
  
  /* Gradient text */
  .gradient-text {
    @apply bg-gradient-to-r from-primary via-purple-500 to-primary bg-clip-text text-transparent;
  }
  
  /* Glass effect */
  .glass {
    @apply bg-white/10 dark:bg-slate-900/10 backdrop-blur-xl;
  }
  
  /* Glow effect */
  .glow {
    @apply shadow-lg shadow-primary/25;
  }
  
  /* Line clamp utilities for text truncation */
  .line-clamp-1 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
  }
  
  .line-clamp-2 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
  }
  
  .line-clamp-3 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
  }
  
  /* Safe area utilities for mobile devices */
  .safe-top {
    padding-top: env(safe-area-inset-top);
  }
  
  .safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .safe-left {
    padding-left: env(safe-area-inset-left);
  }
  
  .safe-right {
    padding-right: env(safe-area-inset-right);
  }
  
  /* Touch target utilities */
  .touch-target {
    @apply min-h-[44px] min-w-[44px];
  }
  
  /* Responsive typography with clamp() - Mobile First */
  .text-responsive-sm {
    font-size: clamp(0.75rem, 2vw, 0.875rem);
  }
  
  .text-responsive-base {
    font-size: clamp(0.875rem, 2.5vw, 1rem);
  }
  
  .text-responsive-lg {
    font-size: clamp(1rem, 3vw, 1.125rem);
  }
  
  .text-responsive-xl {
    font-size: clamp(1.125rem, 3.5vw, 1.25rem);
  }
  
  /* Responsive spacing utilities */
  .space-responsive {
    @apply space-y-4 sm:space-y-6 lg:space-y-8;
  }
  
  .gap-responsive {
    @apply gap-4 sm:gap-5 lg:gap-6;
  }
  
  /* Responsive padding utilities */
  .p-responsive {
    @apply p-4 sm:p-5 lg:p-6;
  }
  
  .px-responsive {
    @apply px-4 sm:px-6 lg:px-8;
  }
  
  .py-responsive {
    @apply py-4 sm:py-6 lg:py-8;
  }
  
  /* Enhanced responsive typography for Analytics page */
  .text-responsive-header {
    font-size: clamp(1.5rem, 4vw + 1rem, 3rem);
    line-height: clamp(1.2, 1.2, 1.2);
  }
  
  .text-responsive-body {
    font-size: clamp(0.875rem, 2vw + 0.5rem, 1.125rem);
    line-height: clamp(1.4, 1.6, 1.6);
  }
  
  .text-responsive-card-title {
    font-size: clamp(0.75rem, 1.5vw + 0.5rem, 1rem);
  }
  
  .text-responsive-card-value {
    font-size: clamp(1.125rem, 3vw + 0.5rem, 2rem);
  }
  
  /* Scrollbar hiding utilities */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
  
  /* Enhanced focus states for accessibility */
  .focus-enhanced {
    @apply focus:outline-none focus:ring-2 focus:ring-primary/30 focus:ring-offset-2 focus:ring-offset-background;
  }
  
  /* Container utilities for different layouts - full width optimization */
  .analytics-container {
    @apply w-full max-w-none px-4 sm:px-6 lg:px-8 xl:px-12 2xl:px-0;
  }
  
  /* Content wrapper for ultra-large screens */
  .analytics-content-wrapper {
    @apply 2xl:px-6 3xl:px-8;
  }
  
  /* Period filter specific styles */
  .period-filter-container {
    @apply relative;
  }
  
  .period-btn {
    @apply focus-enhanced;
  }
  
  /* Chart container styles - optimized spacing */
  .chart-wrapper {
    @apply p-3 sm:p-4 lg:p-5 xl:p-6;
  }
  
  .chart-container {
    @apply relative w-full;
  }
  
  .chart-icon {
    @apply flex-shrink-0;
  }
  
  /* Metrics grid specific styles - reduced gaps */
  .metrics-grid {
    @apply auto-rows-fr;
  }
  
  /* Charts grid specific styles - optimized gaps */
  .charts-grid {
    @apply auto-rows-fr;
  }
  
  .chart-main {
    @apply w-full;
  }
  
  /* Mobile-specific improvements */
  @media (max-width: 640px) {
    .analytics-page {
      @apply overflow-x-hidden;
    }
    
    .period-filter-container {
      @apply -mx-4 px-4;
    }
    
    .period-filter-container > div {
      @apply px-4 -mx-4;
    }
    
    .chart-container {
      @apply overflow-x-auto;
    }
    
    /* Ensure charts don't overflow on mobile */
    .chart-container > * {
      @apply min-w-full;
    }
    
    .chart-wrapper {
      @apply p-3;
    }
  }
  
  /* Tablet-specific improvements */
  @media (min-width: 641px) and (max-width: 1024px) {
    .metrics-grid {
      @apply grid-cols-2;
    }
    
    .charts-grid {
      @apply gap-4;
    }
    
    .chart-wrapper {
      @apply p-4;
    }
  }
  
  /* Desktop-specific improvements */
  @media (min-width: 1025px) and (max-width: 1399px) {
    .metrics-grid {
      @apply grid-cols-4;
    }
    
    .charts-grid {
      @apply gap-4;
    }
    
    .chart-wrapper {
      @apply p-5;
    }
  }
  
  /* Full-width for screens 1400px+ - no side padding */
  @media (min-width: 1400px) {
    .analytics-container {
      @apply px-0;
    }
    
    .analytics-content-wrapper {
      @apply px-6;
    }
    
    .text-responsive-header {
      font-size: clamp(2rem, 3vw, 3.5rem);
    }
    
    .charts-grid {
      @apply gap-5;
    }
    
    .chart-wrapper {
      @apply p-6;
    }
  }
  
  /* Ultra-wide screen optimizations - maximum utilization */
  @media (min-width: 1920px) {
    .analytics-content-wrapper {
      @apply px-8;
    }
    
    .charts-grid {
      @apply gap-6;
    }
    
    .chart-wrapper {
      @apply p-7;
    }
    
    /* Enhanced scaling for ultra-wide screens */
    .text-responsive-header {
      font-size: clamp(2.5rem, 4vw, 4rem);
    }
    
    .text-responsive-body {
      font-size: clamp(1rem, 2vw + 0.5rem, 1.25rem);
    }
  }
  
  /* Optimize chart heights for very large screens */
  @media (min-width: 2560px) {
    .analytics-content-wrapper {
      @apply px-12;
    }
    
    .charts-grid {
      @apply gap-8;
    }
    
    .chart-wrapper {
      @apply p-8;
    }
  }
  
  /* Container query support for responsive components */
  .container-query {
    container-type: inline-size;
  }
  
  /* Container query responsive padding utilities */
  @container (min-width: 20rem) {
    .cq\:p-4 {
      padding: 1rem;
    }
    .cq\:px-4 {
      padding-left: 1rem;
      padding-right: 1rem;
    }
    .cq\:py-4 {
      padding-top: 1rem;
      padding-bottom: 1rem;
    }
  }
  
  @container (min-width: 30rem) {
    .cq\:p-5 {
      padding: 1.25rem;
    }
    .cq\:px-5 {
      padding-left: 1.25rem;
      padding-right: 1.25rem;
    }
    .cq\:py-5 {
      padding-top: 1.25rem;
      padding-bottom: 1.25rem;
    }
    .cq\:text-base {
      font-size: 1rem;
    }
  }
  
  @container (min-width: 40rem) {
    .cq\:p-6 {
      padding: 1.5rem;
    }
    .cq\:px-6 {
      padding-left: 1.5rem;
      padding-right: 1.5rem;
    }
    .cq\:py-6 {
      padding-top: 1.5rem;
      padding-bottom: 1.5rem;
    }
    .cq\:text-lg {
      font-size: 1.125rem;
    }
  }
  
  @container (min-width: 50rem) {
    .cq\:p-8 {
      padding: 2rem;
    }
    .cq\:px-8 {
      padding-left: 2rem;
      padding-right: 2rem;
    }
    .cq\:py-8 {
      padding-top: 2rem;
      padding-bottom: 2rem;
    }
    .cq\:text-xl {
      font-size: 1.25rem;
    }
  }
  
  /* Container query grid utilities */
  @container (min-width: 40rem) {
    .cq\:grid-cols-2 {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }
  
  @container (min-width: 60rem) {
    .cq\:grid-cols-3 {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
  }
  
  @container (min-width: 80rem) {
    .cq\:grid-cols-4 {
      grid-template-columns: repeat(4, minmax(0, 1fr));
    }
  }
}

/* Fix for z-index issues */
.relative > [style*="z-index: 9999"] {
  z-index: 999 !important;
}

/* Prevent layout shift on scrollbar appearance */
.overflow-hidden {
  scrollbar-gutter: stable;
}

/* Period dropdown specific fixes */
.period-dropdown-container {
  @apply relative;
}

.period-dropdown-container > div[class*="absolute"] {
  @apply !w-full !min-w-full;
}

.period-dropdown-container [class*="border-t"] {
  @apply !border-t-0;
}

/* Date input styles */
.period-dropdown-container input[type="date"] {
  @apply block w-full px-3 py-2 border border-border rounded-md shadow-sm 
         bg-white dark:bg-slate-800 text-foreground
         focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary
         text-sm;
  -webkit-appearance: none;
  -moz-appearance: textfield;
}

.period-dropdown-container input[type="date"]::-webkit-calendar-picker-indicator {
  @apply cursor-pointer opacity-60 hover:opacity-100;
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3e%3c/rect%3e%3cline x1='16' y1='2' x2='16' y2='6'%3e%3c/line%3e%3cline x1='8' y1='2' x2='8' y2='6'%3e%3c/line%3e%3cline x1='3' y1='10' x2='21' y2='10'%3e%3c/line%3e%3c/svg%3e");
  background-size: 1rem;
  width: 1rem;
  height: 1rem;
}

/* Dark mode adjustments for date picker */
@media (prefers-color-scheme: dark) {
  .period-dropdown-container input[type="date"] {
    color-scheme: dark;
  }
}

/* Loading shimmer effect */
@keyframes shimmer {
  0% {
    background-position: -200px 0;
  }
  100% {
    background-position: calc(200px + 100%) 0;
  }
}

.skeleton {
  background: linear-gradient(
    90deg,
    hsl(var(--muted)) 0%,
    hsl(var(--muted-foreground) / 0.1) 50%,
    hsl(var(--muted)) 100%
  );
  background-size: 200px 100%;
  animation: shimmer 1.5s ease-in-out infinite;
}

/* Enhanced focus states */
:focus {
  @apply outline-none;
}

:focus-visible {
  @apply outline-2 outline-offset-2 outline-primary;
}

/* Blob animations for backgrounds */
@keyframes blob {
  0% {
    transform: translate(0px, 0px) scale(1);
  }
  33% {
    transform: translate(30px, -50px) scale(1.1);
  }
  66% {
    transform: translate(-20px, 20px) scale(0.9);
  }
  100% {
    transform: translate(0px, 0px) scale(1);
  }
}

.animate-blob {
  animation: blob 7s infinite;
}

.animation-delay-2000 {
  animation-delay: 2s;
}

.animation-delay-4000 {
  animation-delay: 4s;
}