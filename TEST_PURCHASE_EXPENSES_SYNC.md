# Инструкция по проверке синхронизации закупок и расходов

## Подготовка

1. **Убедитесь, что запущены оба сервера:**
   - Frontend: http://localhost:5174/ (уже запущен)
   - Backend: http://localhost:3000/ (запустите командой `cd backend && npm start`)

## Шаги для проверки

### 1. Создание закупки и проверка расхода

1. **Откройте страницу закупок:**
   - Перейдите по адресу: http://localhost:5174/purchases

2. **Создайте новую закупку:**
   - Заполните форму:
     - Дата: выберите сегодняшнюю дату
     - Поставщик: например, "Сафия"
     - Курс лиры: 3.2 (или любой другой)
     - Срок доставки: 7 дней
   
3. **Добавьте несколько товаров:**
   - Нажмите "Добавить товар" 2-3 раза
   - Для каждого товара выберите:
     - Товар из списка
     - Количество: 10, 20, 30 (разные)
     - Цена за единицу в TRY: 15, 25, 35 (разные)

4. **Создайте закупку:**
   - Нажмите кнопку "Создать закупку"
   - Обратите внимание на сумму в рублях под товарами

5. **Проверьте расходы:**
   - Перейдите на страницу расходов: http://localhost:5174/expenses
   - Найдите новый расход с описанием "Закупка у поставщика Сафия"
   - Проверьте:
     - Тип расхода: "Прочее" (должен быть зеленого цвета)
     - Сумма соответствует сумме закупки в рублях
     - В колонке "ТОВАР" отображается количество товаров (например, "3 товара")

### 2. Проверка отображения товаров

1. **Для закупки с небольшим количеством товаров (1-3):**
   - Товары должны отображаться сразу в таблице
   - Можно нажать на количество товаров, чтобы развернуть/свернуть список

2. **Для закупки с большим количеством товаров (более 3):**
   - Отображается только количество (например, "5 товаров")
   - При клике открывается модальное окно со всеми товарами
   - В модальном окне видна таблица с:
     - Названиями товаров
     - Количеством
     - Ценой за единицу в TRY
     - Суммой по каждому товару

### 3. Оприходование закупки с расходами на доставку

1. **Вернитесь на страницу закупок**

2. **Найдите созданную закупку в истории**

3. **Нажмите кнопку оприходования (зеленая галочка)**

4. **В модальном окне:**
   - Проверьте/измените количество полученных товаров
   - Укажите расходы на доставку: например, 500 рублей
   - Нажмите "Оприходовать"

5. **Проверьте расходы:**
   - Вернитесь на страницу расходов
   - Найдите новый расход типа "Логистика"
   - Проверьте:
     - Описание: "Доставка закупки от Сафия"
     - Сумма: 500 рублей (как указали)

### 4. Дополнительные проверки

1. **Фильтрация:**
   - На странице расходов выберите тип "Прочее"
   - Должны отобразиться только расходы этого типа
   - Расходы-закупки должны быть зеленого цвета

2. **Поиск:**
   - В поле поиска введите название поставщика
   - Должен найтись соответствующий расход

3. **График:**
   - Проверьте, что новые расходы отображаются на графике

## Возможные проблемы

1. **Если расход не создается:**
   - Проверьте консоль браузера (F12) на наличие ошибок
   - Убедитесь, что backend сервер запущен
   - Проверьте, что API доступен по адресу http://localhost:3000/api

2. **Если товары не отображаются:**
   - Обновите страницу (F5)
   - Проверьте, что в базе данных сохранилось поле purchaseItems

## Ожидаемый результат

- При создании закупки автоматически создается расход
- Расходы-закупки визуально отличаются (зеленый цвет)
- Можно просмотреть детали закупки прямо на странице расходов
- При оприходовании с расходами на доставку создается отдельный расход типа "Логистика" 