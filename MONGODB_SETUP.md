# üçÉ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ MongoDB –¥–ª—è TELESITE Analytics

## üìã –ß—Ç–æ —Å–µ–π—á–∞—Å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

–í–∞—à –ø—Ä–æ–µ–∫—Ç —Å–µ–π—á–∞—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ **–¥–µ–º–æ-—Ä–µ–∂–∏–º–µ**, –ø–æ—Ç–æ–º—É —á—Ç–æ MongoDB –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. 
API —Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ, –Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –Ω—É–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å MongoDB.

## üöÄ –í–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è MongoDB

### 1. **MongoDB Atlas (–æ–±–ª–∞—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ) - –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø**

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ [mongodb.com](https://www.mongodb.com/atlas)
2. –°–æ–∑–¥–∞–π—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª–∞—Å—Ç–µ—Ä (–≤—ã–±–µ—Ä–∏—Ç–µ FREE tier)
4. –í —Ä–∞–∑–¥–µ–ª–µ "Database Access" —Å–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. –í —Ä–∞–∑–¥–µ–ª–µ "Network Access" –¥–æ–±–∞–≤—å—Ç–µ IP `0.0.0.0/0` (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
6. –ü–æ–ª—É—á–∏—Ç–µ connection string –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
   ```
   mongodb+srv://username:password@cluster.mongodb.net/telesite?retryWrites=true&w=majority
   ```

### 2. **–õ–æ–∫–∞–ª—å–Ω—ã–π MongoDB**

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ MongoDB:
   ```bash
   # macOS
   brew install mongodb-community
   
   # Windows
   # –°–∫–∞—á–∞–π—Ç–µ —Å mongodb.com
   
   # Ubuntu
   sudo apt install mongodb
   ```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ MongoDB:
   ```bash
   mongod --dbpath /path/to/data/directory
   ```

3. Connection string –±—É–¥–µ—Ç:
   ```
   mongodb://localhost:27017/telesite
   ```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:**
   ```bash
   # –í –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
   touch .env
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ –≤ `.env` –≤–∞—à MongoDB URI:**
   ```env
   MONGODB_URI=mongodb+srv://your-username:your-password@your-cluster.mongodb.net/telesite?retryWrites=true&w=majority
   VITE_API_URL=/api
   ```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (Ctrl+C)
   # –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞
   npm run dev:api
   ```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ MongoDB:

### `products` - –¢–æ–≤–∞—Ä—ã
```json
{
  "_id": "ObjectId",
  "id": "number",
  "name": "string",
  "costPriceTRY": "number",
  "costPriceRUB": "number", 
  "stock_quantity": "number",
  "price": "string",
  "created_at": "ISODate",
  "updated_at": "ISODate"
}
```

### `customerOrders` - –ó–∞–∫–∞–∑—ã –∫–ª–∏–µ–Ω—Ç–æ–≤
```json
{
  "_id": "ObjectId",
  "id": "string",
  "paymentDate": "string",
  "customerId": "string",
  "customerName": "string",
  "address": "string",
  "deliveryCost": "number",
  "productName": "string",
  "quantity": "number",
  "price": "number",
  "status": "string"
}
```

### `expenses` - –†–∞—Å—Ö–æ–¥—ã
```json
{
  "_id": "ObjectId", 
  "id": "string",
  "date": "string",
  "type": "string",
  "description": "string",
  "amountRUB": "number",
  "createdAt": "ISODate"
}
```

## üéØ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ MongoDB –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:

1. **API Health Check:**
   ```bash
   curl http://localhost:3000/api/health
   ```
   
   –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:
   ```json
   {
     "status": "ok",
     "message": "API is working with MongoDB!",
     "database": "connected"
   }
   ```

2. **–ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:5173`
   - –î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∏–∑ –≤–∞—à–µ–π MongoDB –±–∞–∑—ã
   - –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ API

## üîç –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "MongoDB connection failed"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å MONGODB_URI
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ IP –∞–¥—Ä–µ—Å –¥–æ–±–∞–≤–ª–µ–Ω –≤ whitelist (Atlas)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å

### –ü—Ä–æ–±–ª–µ–º–∞: "ECONNREFUSED"
- –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ MongoDB: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ mongod –∑–∞–ø—É—â–µ–Ω
- –î–ª—è Atlas: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞: "Authentication failed"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ username/password –≤ connection string
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω –≤ Database Access

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ API —Å–µ—Ä–≤–µ—Ä–∞
npm run dev:api

# –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
npm run dev

# –ó–∞–ø—É—Å–∫ API + —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
npm run dev:full

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è API
curl http://localhost:3000/api/health

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ API —Å–µ—Ä–≤–µ—Ä–∞
# (–ª–æ–≥–∏ –≤–∏–¥–Ω—ã –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω dev:api)
```

## üéâ –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

1. ‚úÖ –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∏–∑ –≤–∞—à–µ–π MongoDB
2. ‚úÖ –ò—Å—á–µ–∑–Ω–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–¥–µ–º–æ-—Ä–µ–∂–∏–º–∞"  
3. ‚úÖ –í—ã —Å–º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
4. ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ –±–∞–∑–µ
5. ‚úÖ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –±—É–¥–µ—Ç —Å—Ç—Ä–æ–∏—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

**–ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?** –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ API —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ issue —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏. 